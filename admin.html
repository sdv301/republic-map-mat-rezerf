<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–∞–º–∏ - –ö–∞—Ä—Ç–∞ –Ø–∫—É—Ç–∏–∏</title>
  <style>
    body { 
      font-family: -apple-system, system-ui, sans-serif; 
      background: rgba(15, 23, 42, 0.65); /* –¢–µ–º–Ω–æ–µ —Å—Ç–µ–∫–ª–æ */
      margin: 0; 
      padding: 20px;
      color: #f1f5f9;
    }
    .container { 
      max-width: 800px; 
      margin: 0 auto; 
    }
    .back-btn {
      display: inline-flex; 
      align-items: center; 
      gap: 8px;
      margin-bottom: 20px; 
      padding: 10px 20px; 
      background: #38bdf8; 
      color: #0f172a; 
      text-decoration: none; 
      border-radius: 8px; 
      font-weight: 600; 
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .back-btn:hover {
      background: #0ea5e9;
      transform: translateY(-2px);
    }
    .block { 
      background: rgba(30, 41, 59, 0.85); 
      padding: 25px; 
      border-radius: 12px; 
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      margin-bottom: 20px;
    }
    h2 { margin-top: 0; color: #38bdf8; font-size: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; }
    h3 { margin-top: 0; color: #f1f5f9; font-size: 1.2rem; }
    p { color: #94a3b8; font-size: 0.95rem; line-height: 1.5; }
    
    .form-row { display: flex; gap: 15px; margin-top: 15px; flex-wrap: wrap; align-items: center;}
    
    input[type="file"] {
      background: rgba(0,0,0,0.3);
      color: #f1f5f9;
      padding: 10px;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 6px;
      flex: 1;
    }
    
    .btn { 
      background: #38bdf8; 
      color: #0f172a; 
      border: none; 
      padding: 10px 20px; 
      border-radius: 6px; 
      cursor: pointer; 
      font-weight: 600;
      transition: background 0.2s;
    }
    .btn:hover { background: #0ea5e9; }
    .btn.export { background: #10b981; color: white; }
    .btn.export:hover { background: #059669; }

    #notification {
      position: fixed; top: 20px; right: 20px;
      padding: 15px 25px; border-radius: 8px; color: white;
      font-weight: bold; opacity: 0; transition: opacity 0.3s;
      pointer-events: none; z-index: 1000;
    }
    .success { background: #10b981; }
    .error { background: #ef4444; }
  </style>
</head>
<body>
  <div class="container">
    <a href="/" class="back-btn">‚¨Ö –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –∫–∞—Ä—Ç—É</a>
    
    <h2>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ú–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –†–µ–∑–µ—Ä–≤–∞–º–∏ (–ú–¶)</h2>

    <div class="block">
      <h3>üì• –ò–º–ø–æ—Ä—Ç –≤–µ–¥–æ–º–æ—Å—Ç–∏ –≤—ã–¥–∞—á–∏ (Excel/CSV)</h3>
      <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å–æ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –≤—ã–¥–∞—á–∏ –∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ —Ä–∞–π–æ–Ω–∞–º.<br>
         –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –ø—Ä–∏–≤—è–∂–µ—Ç –∏—Ö –∫ —Ä–∞–π–æ–Ω–∞–º –Ω–∞ –∫–∞—Ä—Ç–µ.</p>
      <div class="form-row">
        <input type="file" id="excelFile" accept=".xlsx, .xls, .csv">
        <button class="btn" onclick="importExcel()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ –±–∞–∑—É</button>
      </div>
    </div>

    <div class="block">
      <h3>üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Excel</h3>
      <p>–í—ã–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ —É–¥–æ–±–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (–≤—Å–µ –≤—ã–¥–∞–Ω–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤—ã –ø–æ —Ä–∞–π–æ–Ω–∞–º).</p>
      <div class="form-row">
        <button class="btn export" onclick="exportExcel()">üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç (Excel)</button>
      </div>
    </div>
  </div>

  <div id="notification"></div>

  <script>
    const API = 'http://localhost:5000/api';

    function notify(text, isErr = false) {
      const el = document.getElementById('notification');
      el.textContent = text;
      el.className = isErr ? 'error' : 'success';
      el.style.opacity = 1;
      setTimeout(() => el.style.opacity = 0, 3000);
    }

    async function importExcel() {
      const fileInput = document.getElementById('excelFile');
      const file = fileInput.files[0];
      if (!file) return notify('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª', true);

      notify('–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...', false);
      const fd = new FormData();
      fd.append('file', file);

      try {
        const res = await fetch(`${API}/upload-excel`, { method: 'POST', body: fd });
        const result = await res.json();
        
        if (res.ok && result.success) {
          notify(result.message || '–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
          fileInput.value = ''; // –û—á–∏—â–∞–µ–º –∏–Ω–ø—É—Ç
        } else {
          notify(result.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ', true);
        }
      } catch (e) {
        notify('–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º', true);
      }
    }

    function exportExcel() {
      window.location.href = `${API}/export-excel`;
    }
  </script>
</body>
</html>